<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>analisi_della_varianza – IML</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d1aacd23651da4810371d54805babc2f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../th/01. Richiami di probabilità.html">Theory</a></li><li class="breadcrumb-item"><a href="../th/14_Analisi_della_varianza.html">Analisi della varianza</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">IML</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/01. Richiami di probabilità.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Richiami di Probabilità</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/02. Variabili aleatorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variabili Aleatorie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/03. Modelli di variabili aleatorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelli di variabili aleatorie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/04. La distribuzione delle statistiche campionarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">La distribuzione delle statistiche campionarie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/05. Stima parametrica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stima parametrica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/06. Verifica delle ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Verifica delle ipotesi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/07. Vettori aleatori.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vettori aleatori</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/08_Analisi_delle_componenti_principali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analisi delle componenti principali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/09_Funzioni_di_Perdita_e_Inferenza.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Funzioni di Perdita e Inferenza</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/10. Ancora sul teorema di Cochran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ancora sul teorema di Cochran</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/11. Selezione di Variabili e Regolarizzazione nella Regressione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selezione di Variabili e Regolarizzazione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/12_gestione_delle_variabili.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gestione delle variabili</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/13_Regressione_logistica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regressione logistica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/14_Analisi_della_varianza.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Analisi della varianza</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/15. ANOVA a due vie (con o senza repliche).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA a due vie (con o senza repliche)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../th/16_Test_del_chi-quadro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Test del Chi-quadro</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Laboratory</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/01_02_Introduzione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-02: Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/03_04_Gaussiane.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-04: Gaussiane</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/05_06_Limite_Centrale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-06: Limite Centrale</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/07_08_EDA_PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-08: EDA e PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/09_10_Generazione_campioni.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-10: Generazione campioni da distribuzione scelta</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/11_12_MLE_Regressione_Abalone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-12: MLE e Regressione Abalone</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/13_14_Outlier_Regressione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13-14: Outlier e Regressione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab/15_16_OLS_Abalone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15-16: OLS (Abalone)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Exams</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_1_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-01: Analisi distribuzione Dirichlet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_1_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-02: EDA e PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_1_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-03: Classificazione Logistic Regression e PyTorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_1_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-04: Regressione con OLS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_1_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-05: Minimizzazione con SciPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-01: Analisi distribuzione custom</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exams/esame_2_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-02: Analisi dataset Gallstone</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#analisi-della-varianza" id="toc-analisi-della-varianza" class="nav-link active" data-scroll-target="#analisi-della-varianza">Analisi della varianza</a>
  <ul class="collapse">
  <li><a href="#anova-a-una-via" id="toc-anova-a-una-via" class="nav-link" data-scroll-target="#anova-a-una-via">ANOVA a una via</a></li>
  <li><a href="#stima-dei-parametri" id="toc-stima-dei-parametri" class="nav-link" data-scroll-target="#stima-dei-parametri">Stima dei parametri</a></li>
  <li><a href="#il-test-anova" id="toc-il-test-anova" class="nav-link" data-scroll-target="#il-test-anova">Il test ANOVA</a></li>
  <li><a href="#aspetti-operativi" id="toc-aspetti-operativi" class="nav-link" data-scroll-target="#aspetti-operativi">Aspetti operativi</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../th/01. Richiami di probabilità.html">Theory</a></li><li class="breadcrumb-item"><a href="../th/14_Analisi_della_varianza.html">Analisi della varianza</a></li></ol></nav></header>




<section id="analisi-della-varianza" class="level1">
<h1>Analisi della varianza</h1>
<p>L’analisi della varianza, o ANOVA, è una tecnica statistica utilizzata per studiare la dipendenza di una variabile numerica <span class="math inline">\(Y\)</span> da una o più variabili esplicative di tipo <strong>categorico</strong>. L’idea di fondo è confrontare le medie di <span class="math inline">\(Y\)</span> tra diversi gruppi e stabilire se le differenze osservate possano essere attribuite al caso oppure siano statisticamente significative.</p>
<p>A differenza della regressione lineare classica, in cui le covariate sono numeriche, nell’ANOVA i regressori assumono un numero finito di modalità, come gruppi, livelli o trattamenti. Il modello statistico sottostante assume che la variabile risposta sia affetta da <strong>rumore additivo gaussiano omoschedastico</strong>, cioè errori indipendenti, normalmente distribuiti e con varianza costante.</p>
<p>A seconda del numero di fattori considerati, si distinguono diverse configurazioni. Nell’ANOVA a una via è presente un solo fattore categorico; nell’ANOVA a due vie entrano in gioco due fattori; infine, nell’ANOVA a due vie con repliche si hanno più osservazioni per ciascuna combinazione dei livelli dei fattori.</p>
<section id="anova-a-una-via" class="level2">
<h2 class="anchored" data-anchor-id="anova-a-una-via">ANOVA a una via</h2>
<p>Nel caso più semplice si considera un unico fattore categoriale con <span class="math inline">\(m\)</span> livelli. Ogni osservazione <span class="math inline">\(Y_{ij}\)</span> appartiene al gruppo <span class="math inline">\(i\)</span> ed è la <span class="math inline">\(j\)</span>-esima replica all’interno di quel gruppo. Il modello è</p>
<p><span class="math display">\[
Y_{ij} = \mu_i + \varepsilon_{ij}, \qquad \varepsilon_{ij} \sim \mathcal{N}(0, \sigma^2),
\]</span></p>
<p>dove <span class="math inline">\(\mu_i\)</span> rappresenta la media del gruppo <span class="math inline">\(i\)</span> e <span class="math inline">\(\sigma^2\)</span> è la varianza comune a tutti i gruppi. L’indice <span class="math inline">\(i = 1,\dots,m\)</span> identifica i gruppi, mentre <span class="math inline">\(j = 1,\dots,n_i\)</span> indica le osservazioni disponibili nel gruppo <span class="math inline">\(i\)</span>.</p>
<p>L’ipotesi nulla del test ANOVA a una via afferma che tutte le medie di gruppo coincidano,</p>
<p><span class="math display">\[
H_0:\ \mu_1 = \mu_2 = \dots = \mu_m,
\]</span></p>
<p>mentre l’alternativa sostiene che almeno una media sia diversa. In termini interpretativi, il test verifica se la variabilità osservata tra le medie dei gruppi sia sufficientemente grande rispetto alla variabilità interna ai gruppi. Se così non fosse, le differenze tra gruppi possono essere spiegate come semplici fluttuazioni casuali; in caso contrario, si conclude che la variabile risposta <span class="math inline">\(Y\)</span> dipende in modo significativo dal gruppo di appartenenza.</p>
</section>
<section id="stima-dei-parametri" class="level2">
<h2 class="anchored" data-anchor-id="stima-dei-parametri">Stima dei parametri</h2>
<p>Nel modello ANOVA a una via, per ciascun gruppo <span class="math inline">\(i\)</span> si stimano i parametri tramite le statistiche campionarie. In particolare, la media campionaria <span class="math inline">\(\bar Y_i\)</span> fornisce una stima naturale della media di gruppo <span class="math inline">\(\mu_i\)</span>, mentre la varianza campionaria <span class="math inline">\(S_i^2\)</span> stima la varianza comune <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Sotto le ipotesi del modello, la media campionaria di ciascun gruppo ha distribuzione normale,</p>
<p><span class="math display">\[
\bar Y_i \sim \mathcal{N}\!\left( \mu_i, \frac{\sigma^2}{n_i} \right),
\]</span></p>
<p>poiché è la media di <span class="math inline">\(n_i\)</span> osservazioni indipendenti gaussiane con varianza <span class="math inline">\(\sigma^2\)</span>. Le varianze campionarie <span class="math inline">\(S_i^2\)</span> sono invece stimatori non distorti della stessa varianza <span class="math inline">\(\sigma^2\)</span>, ma basati solo sulle osservazioni del singolo gruppo.</p>
<p>Per sfruttare l’ipotesi di varianza comune, si introduce una stima globale ottenuta aggregando l’informazione di tutti i gruppi. A questo scopo si definisce la <strong>devianza within</strong> (o devianza interna ai gruppi),</p>
<p><span class="math display">\[
\mathrm{SS}_W = \sum_{i=1}^m \sum_{j=1}^{n_i} \bigl(Y_{ij} - \bar Y_i\bigr)^2,
\]</span></p>
<p>che misura la variabilità delle osservazioni attorno alle rispettive medie di gruppo. Dividendo questa quantità per i gradi di libertà residui <span class="math inline">\(N - m\)</span>, con <span class="math inline">\(N = \sum_{i=1}^m n_i\)</span>, si ottiene la stima pooled della varianza,</p>
<p><span class="math display">\[
S_p^2 = \frac{\mathrm{SS}_W}{N - m}.
\]</span></p>
<p>Sotto le ipotesi del modello, questa statistica ha una distribuzione chi-quadrato scalata,</p>
<p><span class="math display">\[
\frac{(N - m) S_p^2}{\sigma^2} \sim \chi^2_{N - m},
\]</span></p>
<p>risultato che è fondamentale per la costruzione del test ANOVA.</p>
<p>Accanto alla devianza interna, si considera la <strong>devianza totale</strong>,</p>
<p><span class="math display">\[
\mathrm{SS}_Y = \sum_{i=1}^m \sum_{j=1}^{n_i} \bigl(Y_{ij} - \bar Y\bigr)^2,
\]</span></p>
<p>dove <span class="math inline">\(\bar Y\)</span> è la media complessiva di tutte le osservazioni. Questa quantità misura la variabilità totale di <span class="math inline">\(Y\)</span> senza tenere conto della struttura a gruppi.</p>
<p>La parte di variabilità attribuibile alle differenze tra i gruppi è descritta dalla <strong>devianza between</strong>,</p>
<p><span class="math display">\[
\mathrm{SS}_B = \sum_{i=1}^m n_i \bigl(\bar Y_i - \bar Y\bigr)^2,
\]</span></p>
<p>che confronta le medie di gruppo con la media globale, pesandole per le rispettive numerosità.</p>
<p>Queste tre devianze sono legate dalla classica <strong>identità delle devianze</strong>,</p>
<p><span class="math display">\[
\mathrm{SS}_Y = \mathrm{SS}_B + \mathrm{SS}_W,
\]</span></p>
<p>che formalizza l’idea centrale dell’ANOVA: la variabilità totale della risposta può essere scomposta in una componente dovuta alle differenze tra gruppi e una componente dovuta alla variabilità interna ai gruppi.</p>
</section>
<section id="il-test-anova" class="level2">
<h2 class="anchored" data-anchor-id="il-test-anova">Il test ANOVA</h2>
<p>Per stabilire se le medie di gruppo siano tutte uguali si formalizza il problema come un test di ipotesi. L’ipotesi nulla afferma che non vi siano differenze sistematiche tra i gruppi,</p>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 = \dots = \mu_m,
\]</span></p>
<p>mentre l’ipotesi alternativa sostiene che almeno una delle medie differisca dalle altre.</p>
<p>L’idea centrale del test ANOVA è confrontare due stime della varianza <span class="math inline">\(\sigma^2\)</span>: una basata sulla variabilità <strong>tra</strong> i gruppi e una basata sulla variabilità <strong>interna</strong> ai gruppi. La prima è ottenuta dividendo la devianza between per i suoi gradi di libertà,</p>
<p><span class="math display">\[
S_B^2 = \frac{\mathrm{SS}_B}{m - 1},
\]</span></p>
<p>mentre la seconda coincide con la stima pooled già introdotta,</p>
<p><span class="math display">\[
S_p^2 = \frac{\mathrm{SS}_W}{N - m}.
\]</span></p>
<p>La statistica test è quindi il loro rapporto,</p>
<p><span class="math display">\[
F = \frac{S_B^2}{S_p^2}
  = \frac{\mathrm{SS}_B / (m - 1)}{\mathrm{SS}_W / (N - m)}.
\]</span></p>
<p>Sotto l’ipotesi nulla, entrambe le quantità al numeratore e al denominatore stimano la stessa varianza <span class="math inline">\(\sigma^2\)</span>, e il loro rapporto segue una distribuzione di Fisher–Snedecor con <span class="math inline">\(m-1\)</span> e <span class="math inline">\(N-m\)</span> gradi di libertà,</p>
<p><span class="math display">\[
F \sim F(m - 1,\ N - m).
\]</span></p>
<p>Il criterio decisionale consiste nel confrontare il valore osservato della statistica con il quantile superiore della distribuzione <span class="math inline">\(F\)</span>. Se il valore di <span class="math inline">\(F\)</span> risulta sufficientemente grande, ossia maggiore del quantile critico <span class="math inline">\(F_{\alpha}(m-1, N-m)\)</span> per un livello di significatività <span class="math inline">\(\alpha\)</span>, si rifiuta l’ipotesi nulla. In tal caso si conclude che la variabilità tra le medie di gruppo è troppo elevata per essere spiegata dal solo rumore interno, e quindi che almeno un gruppo presenta una media diversa dalle altre.</p>
</section>
<section id="aspetti-operativi" class="level2">
<h2 class="anchored" data-anchor-id="aspetti-operativi">Aspetti operativi</h2>
<p>Dal punto di vista pratico, i dati per un’analisi ANOVA possono essere organizzati secondo due strutture principali. Nel <strong>formato wide</strong> ogni gruppo è rappresentato da una colonna distinta, ciascuna contenente le osservazioni relative a quel livello del fattore. Nel <strong>formato long</strong> (o stacked), invece, tutte le osservazioni sono raccolte in un’unica colonna numerica, affiancata da una colonna categoriale che indica il gruppo di appartenenza. Quest’ultimo formato è in genere preferito dai software statistici e risulta più flessibile quando si passa a modelli con più fattori.</p>
<p>Una volta stimato il modello e svolto il test ANOVA, è fondamentale verificare a posteriori la validità delle ipotesi su cui il modello si basa. Questo controllo viene effettuato analizzando i <strong>residui</strong>, ossia le differenze tra le osservazioni e le corrispondenti medie di gruppo. In particolare, ci si aspetta che i residui siano approssimativamente normali, che mostrino una variabilità simile nei diversi gruppi (omoschedasticità) e che non presentino valori anomali particolarmente influenti.</p>
<p>Qualora queste condizioni risultino violate, una strategia comune consiste nell’applicare una trasformazione alla variabile risposta <span class="math inline">\(Y\)</span>, come il logaritmo o la radice quadrata. Tali trasformazioni possono ridurre l’asimmetria, stabilizzare la varianza e rendere più plausibili le assunzioni del modello.</p>
<p>Infine, se il test ANOVA non risulta significativo, non vi è evidenza statistica di differenze tra le medie di gruppo. In questo caso è ragionevole trattare l’intero insieme di dati come un unico campione proveniente da una stessa distribuzione gaussiana, ignorando il fattore categoriale senza perdita informativa rilevante.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>